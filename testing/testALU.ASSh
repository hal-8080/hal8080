# Testing all the alu operations
# Assembler issues: 
#	RET is expected to have a $Rs
#	RAND is expected to have a $Rs
 
# @_BUTTONS_@ = x"FAAA"
# @_PREVBUTTONS_@ = x"FAAB"

# $r2 = TempVal
# $r3 = ButtonState
# $r4 = ChangedButtons

GETINPUT:    
    LD $r3, @_BUTTONS_@
    LD $r4, @_PREVBUTTONS_@
    INV $r4, $r4
    AND $r4, $r3
    ST $r3, @_PREVBUTTONS_@
    SETHI $r2, x"10"
    SETLO $r2, x"00"
    AND $r2, $r4
    BZERO @GETINPUT
    RET

CP $r2, $r1     # r2 =  0000 0000  0000 0001
DISPRHR $r2
CALL @GETINPUT  # DSP=  0000 0000  0000 0001        x0001

SHIFTL $r2, 15  # r2 =  1000 0000  0000 0000
DISPRHR $r2
CALL @GETINPUT  # DSP=  1000 0000  0000 0000        x8000

SHIFTR $r2, 7   # r2 =  1111 1111  0000 0000
DISPRHR $r2
CALL @GETINPUT  # DSP=  1111 1111  0000 0000        xFF00

INV $r3, $r2    # r2 =  1111 1111  0000 0000
DISPRHR $r3     # r3 =  0000 0000  1111 1111
CALL @GETINPUT  # DSP=  0000 0000  1111 1111        x00FF

AND $r2, $r3    # r2 =  1111 1111  1111 1111
DISPRHR $r2     # r3 =  0000 0000  1111 1111
CALL @GETINPUT  # DSP=  1111 1111  1111 1111        xFFFF

NAND $r3, $r2   # r2 =  1111 1111  1111 1111
DISPRHR $r3     # r3 =  1111 1111  0000 0000
CALL @GETINPUT  # DSP=  1111 1111  0000 0000        xFF00

XOR $r3, $r2    # r2 =  1111 1111  1111 1111
DISPRHR $r3     # r3 =  0000 0000  1111 1111
CALL @GETINPUT  # DSP=  0000 0000  1111 1111        x00FF

OR $r3, $r2     # r2 =  1111 1111  1111 1111
DISPRHR $r3     # r3 =  1111 1111  1111 1111
CALL @GETINPUT  # DSP=  1111 1111  1111 1111        xFFFF

SUB $r3, $r2    # r2 =  1111 1111  1111 1111
DISPRHR $r3     # r3 =  0000 0000  0000 0000
CALL @GETINPUT  # DSP=  0000 0000  0000 0000        x0000

ADD $r3, "01111"  # r2 =  1111 1111  1111 1111
DISPRHR $r3     # r3 =  0000 0000  0000 1111
CALL @GETINPUT  # DSP=  0000 0000  0000 1111        x000F

SETLO $r2, x"00"# r2 =  1111 1111  0000 0000
DISPRHR $r2     # r3 =  0000 0000  0000 1111
CALL @GETINPUT  # DSP=  1111 1111  0000 0000        xFF00

ORN $r2, $r3    # r2 =  1111 1111  1111 0000
DISPRHR $r2     # r3 =  0000 0000  0000 1111
CALL @GETINPUT  # DSP=  1111 1111  1111 0000        xFFF0

SETHI $r2, x"00" # 00000000 
SETLO $r2, x"0F" # 00001111
SETHI $r3, x"01" # 00000001
SETLO $r3, x"01" # 00000001
# r2 = 15  = 0000 0000  0000 1111
# r3 = 257 = 0000 0001  0000 0001
# r2 * r3 = 15 * 257 = 3855
# 3855 = 0000 1111  0000 1111

MUL $r2, $r3    # r2 =  0000 1111  0000 1111
DISPRHR $r2     # r3 =  0000 0001  0000 0001
CALL @GETINPUT  # DSP=  0000 1111  0000 1111        x0F0F

# 3855 / 257 = 15 = 0000 0000  0000 1111
DIV $r2, $r3    # r2 =  0000 0000  0000 1111
DISPRHR $r2     # r3 =  0000 0001  0000 0001
CALL @GETINPUT  # DSP=  0000 0000  0000 1111        x000F

SETHI $r2, x"00"
SETLO $r2, x"05"
# r2 = 5 = 0000 0000  0000 0101

POW $r2, $r2    # r2 =  0000 1100  0011 0101
DISPRHR $r2     # r3 =  0000 0001  0000 0001
CALL @GETINPUT  # DSP=  0000 1100  0011 0101        x0C35

RANDOM:
    RAND $r2
    DISPRHR $r2 #                                   x<RANDOM>
    CALL @GETINPUT
    BA @RANDOM
